
async function Печать()
{
	let source = element("main").innerHTML;
	let layout = new Layout();
	let worksheet = await layout.worksheet(source);

	let a = document.createElement("a");
    a.download = "test.xlsx";
	let type = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
    a.href = "data:" + type + ";base64," + worksheet;
    a.click();
}

async function Загрузка()
{
	await dataset.begin();
	let query =  { "from": "ПокупкаПорядок",
		           "where" : { "Пользователь" : auth.account },
		           "filter" : { "deleted": "" }	};
	let records = await dataset.select(query);
	for (let id of records)
	{
		let entry = await dataset.find(id);
		let record = await dataset.find(entry.Номенклатура);
		let template = new Template("template");
		template.fill(record);

		template.out("tbody");

		let qr = "https://xn--40-6kcai3c0bf.xn--p1ai/?id=" + record.id;
		let qrcode = new QRCode(element("#qrcode-" + record.id));
		qrcode.makeCode(qr);

		let img = element("#qrcode-" + record.id + " img");
		img.classList.add("img-fluid");

		// let record =
		// {
		// 	"template": "#first",
		// 	"qrcode": "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",
		// 	"title": entry.title,
		// 	"Штрихкод": "00016176"
		// };
	}

	// let records =
	// [
	// 	{
	// 		"template": "#first",
	// 		"qrcode": "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",
	// 		"title": "Адаптер для каркаса MOST K300",
	// 		"Штрихкод": "00016176"
	// 	},
	// 	{
	// 		"template": "#second",
	// 		"qrcode": "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",
	// 		"title": "Адаптер для катушки d=200, 5 кг.",
	// 		"Штрихкод": "00090849"
	// 	}
	// ];
	// for (let record of records)
}
